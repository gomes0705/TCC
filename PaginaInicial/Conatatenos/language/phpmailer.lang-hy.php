ult:return"AllResults"}}function y(n,t){return t?"".concat(n," AND (").concat(t,")"):n}function p(t,r,u,f,s,h){var c=n.context,b=c.isSubstrateRelatedSearchEnabled,g=c.isAllEQTEnabled,nt=c.is3sDisplayQueryStringEnabled,tt=c.query,it=c.isCustomRefinerPrefechEnabled,l=nt?tt:r,v=[{EntityType:"File",From:0,Size:f||10,Query:{DisplayQueryString:l,QueryString:r,QueryTemplate:g?y(e(t),u):e(t)},Sort:[{Field:"PersonalScore",SortDirection:"Desc"}],Fields:d,IdFormat:0,ContentSources:t==="Site"?["SharePoint"]:["OneDriveBusiness","SharePoint"],ResultsMerge:{Type:"Interleaved"},EnableQueryUnderstanding:!1,EnableSpeller:!1,ExtendedQueries:[{SearchProvider:"SharePoint",Query:{Culture:k,EnableQueryRules:!1,TrimDuplicates:!1,BypassResultTypes:!0,ProcessBestBets:!1,ProcessPersonalFavorites:!1,EnableInterleaving:!1,EnableMultiGeo:!0,SourceId:"8413CD39-2156-4E00-B54D-11EFD9ABDB89"}}],HitHighlight:{HitHighlightedProperties:t==="Site"?["Title"]:["HitHighlightedSummary"],SummaryLength:200},Aggs:it?o(s):undefined}],p,w;return b&&(p={EntityType:"QueryReformulation",From:0,Size:8,PreferredResultSourceFormat:"EntityData",Query:{DisplayQueryString:l,QueryString:r},ContentSources:["MicrosoftSearch"]},v.push(p)),t=="All"&&(w={BypassResultTypes:!1,EntityType:"External",From:0,Size:2,PreferredResultSourceFormat:"AdaptiveCardTemplateBinding",Query:{DisplayQueryString:l,QueryString:i(h&&h.intent)?a(h===null||h===void 0?void 0:h.itemId,r):r},Sort:[{Field:"Score",SortDirection:"Desc"}],ContentSources:i(h&&h.intent)&&h.contentSource?[h.contentSource]:["Connectors"],HitHighlight:{HitHighlightedProperties:["HitHighlightedSummary"],SummaryLength:200}},v.push(w)),v}function w(t){var u=n.context,e=u.isNLFileSearchEnabled,i=u.isBingSpellerEnabled,f=u.isNLRecourseEnabled,o=u.isSharedSerpAllVerticalEnabled,r;return o?{EnableSuggestion:i,EnableAlteration:!0,SupportedRecourseDisplayTypes:["ServiceSideRecourseLink"]}:!e&&!i?undefined:(r=[],i&&(r.push("Suggestion"),r.push("NoResultModification")),f&&!t&&r.push("NoRequeryModification"),__assign({EnableSuggestion:i,EnableAlteration:!0},(i||f)&&{SupportedRecourseDisplayTypes:r}))}function b(){var i=n.context,r=i.isSubstrateRelatedSearchEnabled,t=i.isS